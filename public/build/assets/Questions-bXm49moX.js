const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/breadcrumbs-kIca6h-8.js","assets/app-DYIeVFXG.js","assets/app-WYjj4XpG.css","assets/QuestionView-Bi9C4ko9.js","assets/SummaryView-Df-QBFR6.js","assets/LazyAdSlot-C_Ry7yeX.js","assets/IntroModal-BHUjrDMY.js","assets/RetakeModal-tw0hLS9q.js","assets/NextModal-B7uFierT.js"])))=>i.map(i=>d[i]);
import{r as e,j as t,a as te,_ as f,f as se}from"./app-DYIeVFXG.js";import{L as ne}from"./Layout-CMqbb4IC.js";import oe from"./AdSlot-DwqybcO-.js";const ae=({isOpen:r,onClose:o,children:u})=>{const n=e.useRef(null),w=e.useRef(null),i=e.useRef(null);return e.useEffect(()=>{if(r){i.current=document.activeElement,setTimeout(()=>{var a;return(a=w.current)==null?void 0:a.focus()},0);const h=a=>{var x;a.key==="Escape"&&o(),a.key==="Tab"&&(a.preventDefault(),(x=w.current)==null||x.focus())};return document.addEventListener("keydown",h),()=>{var a;document.removeEventListener("keydown",h),(a=i.current)==null||a.focus()}}},[r,o]),r?t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",ref:n,role:"dialog","aria-modal":"true",children:t.jsxs("div",{className:"bg-white rounded-lg relative w-full max-w-sm sm:max-w-md md:max-w-lg lg:max-w-2xl p-4 sm:p-6",children:[t.jsx("button",{ref:w,onClick:o,className:"absolute top-3 right-3 text-gray-600 hover:text-gray-800 focus:outline-none","aria-label":"Close advertisement",children:"âœ•"}),t.jsx("div",{className:"w-full",children:u})]})}):null},le=({isOpen:r,onClose:o,title:u,message:n})=>r?t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:t.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4 text-red-600",children:u}),t.jsx("p",{className:"mb-6 text-gray-700",children:n}),t.jsx("button",{onClick:o,className:"w-full bg-red-600 text-white py-2 rounded hover:bg-red-700 transition",children:"Close"})]})}):null,re=e.lazy(()=>f(()=>import("./breadcrumbs-kIca6h-8.js"),__vite__mapDeps([0,1,2]))),ce=e.lazy(()=>f(()=>import("./QuestionView-Bi9C4ko9.js"),__vite__mapDeps([3,1,2]))),ue=e.lazy(()=>f(()=>import("./SummaryView-Df-QBFR6.js"),__vite__mapDeps([4,1,2,5]))),ie=e.lazy(()=>f(()=>import("./IntroModal-BHUjrDMY.js"),__vite__mapDeps([6,1,2]))),de=e.lazy(()=>f(()=>import("./RetakeModal-tw0hLS9q.js"),__vite__mapDeps([7,1,2]))),me=e.lazy(()=>f(()=>import("./NextModal-B7uFierT.js"),__vite__mapDeps([8,1,2]))),z=r=>[...r].sort(()=>Math.random()-.5),pe=({questions:r,subjectId:o,subjectName:u,part:n,examType:w,examId:i})=>{const[h,a]=e.useState(!0),[x,j]=e.useState(!1),[E,k]=e.useState(!1),[c,L]=e.useState(()=>z(r)),[d,N]=e.useState(0),[O,v]=e.useState(null),[R,C]=e.useState(0),[y,P]=e.useState(!1),[D,Q]=e.useState(!1),[V,$]=e.useState([]),[S,b]=e.useState(0),p=e.useRef(null),[q,A]=e.useState(!1),B=()=>a(!1),J=()=>j(!0),F=()=>k(!0),H=()=>{j(!1),U()},K=()=>{k(!1);const s=`prc_unlocked_${i}_${o}`,l=JSON.parse(localStorage.getItem(s)||"[1]"),g=n+1;l.includes(g)||(l.push(g),localStorage.setItem(s,JSON.stringify(l))),se.visit(`/exams/${i}/subjects/${o}/parts/${g}/questions`)},U=()=>{clearInterval(p.current),b(0),p.current=setInterval(()=>b(s=>s+1),1e3),L(z(r)),N(0),v(null),C(0),P(!1),$([])},T=e.useMemo(()=>{const s=c.length;return[Math.floor(s*.25),Math.floor(s*.75)]},[c.length]);e.useEffect(()=>(p.current=setInterval(()=>b(s=>s+1),1e3),()=>clearInterval(p.current)),[]),e.useEffect(()=>{y&&clearInterval(p.current)},[y]);const m=c[d],_=e.useCallback(()=>{d<c.length-1?(N(s=>s+1),v(null)):P(!0)},[d,c.length]),Y=e.useCallback(()=>{T.includes(d+1)?A(!0):_()},[d,T,_]),G=e.useCallback(()=>{A(!1),_()},[_]),W=e.useCallback(s=>{v(s),s===m.answer&&C(l=>l+1),$(l=>[...l,{questionId:m.id,question:m.question,choices:m.choices,selected:s,correct:m.answer,explanation:m.explanation}]);try{const l=`prc_progress_${i}_${o}_${n}`,g=d+1,ee=c.length;localStorage.setItem(l,JSON.stringify({answered:g,total:ee}))}catch(l){console.error("Failed to save progress:",l)}},[m,d,c.length,i,o,n]),I=e.useMemo(()=>`${Math.floor(S/60)}m ${S%60}s`,[S]),M=R/c.length*100,X=M>=80,Z=[{label:"Home",href:"/"},{label:"Exams",href:"/exams"},{label:u,href:`/exams/${i}/subjects/${o}/parts`},{label:`Part ${n}`}];return t.jsxs(ne,{children:[t.jsx(te,{title:`${u} Part ${n} Questions | PRC Board Reviewers PH`,children:t.jsx("meta",{name:"description",content:`Part ${n} of ${u} quiz.`})}),t.jsxs(e.Suspense,{fallback:null,children:[h&&t.jsx(ie,{subjectName:u,part:n,onStart:B}),x&&t.jsx(de,{onRetake:H}),E&&t.jsx(me,{part:n,onContinue:K})]}),!(h||x||E)&&t.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[t.jsx(e.Suspense,{fallback:t.jsx("div",{className:"mb-4 h-4 w-32 bg-gray-200 animate-pulse rounded"}),children:t.jsx(re,{items:Z})}),t.jsx(ae,{isOpen:q,onClose:G,children:t.jsx(oe,{slotId:"questions-popup-banner",className:"w-full h-64"})}),t.jsx(e.Suspense,{fallback:t.jsxs("div",{className:"animate-pulse space-y-4 py-10",children:[t.jsx("div",{className:"h-6 bg-gray-200 rounded w-3/4"}),t.jsx("div",{className:"h-48 bg-gray-200 rounded w-full"}),t.jsx("div",{className:"h-10 bg-gray-200 rounded w-1/2"})]}),children:y?t.jsx(ue,{score:R,total:c.length,percentage:M,formatElapsedTime:I,passed:X,userAnswers:V,onRetake:J,onNextPart:F}):t.jsx(ce,{currentQuestion:m,selectedChoice:O,onChoiceClick:W,onNext:Y,formatElapsedTime:I,questionNumber:d+1,totalQuestions:c.length})}),t.jsx(le,{isOpen:D,onClose:()=>Q(!1),title:"Oops! ðŸ˜Ÿ",message:"You need at least 80% to proceed."})]})]})};export{pe as default};
