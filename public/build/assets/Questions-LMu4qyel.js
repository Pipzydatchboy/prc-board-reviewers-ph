import{j as e,r as a,R as Y,a as K,f as L}from"./app-B2vY00A8.js";import{L as V}from"./Layout-DF7u9FYC.js";import H from"./breadcrumbs-C7xN6_f6.js";const U=({currentQuestion:o,selectedChoice:t,onChoiceClick:s,onNext:n,formatElapsedTime:l,questionNumber:m,totalQuestions:p})=>e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold mb-4 text-green-700 antialiased",children:["ðŸ“‹ Question ",m," of ",p]}),e.jsxs("p",{className:"text-sm text-gray-600 mb-4 antialiased",children:["Elapsed Time: ",l]}),e.jsxs("div",{className:"p-6 bg-white border rounded-2xl shadow relative text-gray-800 antialiased",children:[e.jsx("p",{className:"font-semibold mb-4 text-lg leading-relaxed",children:o.question}),e.jsx("ul",{className:"space-y-2",children:o.choices.map((x,g)=>{let u="";return t&&(x===o.answer?u="bg-green-200 border-green-500":x===t&&(u="bg-red-200 border-red-500")),e.jsx("li",{children:e.jsx("button",{onClick:()=>s(x),disabled:!!t,className:`block w-full text-left p-3 border rounded text-gray-800 ${u} ${t?"":"hover:bg-gray-100"}`,children:x})},g)})}),t&&e.jsxs("div",{className:"mt-6 p-4 rounded border bg-gray-100 border-gray-300",children:[e.jsx("p",{className:"font-semibold mb-2",children:"Explanation:"}),e.jsx("p",{className:"italic leading-relaxed",children:o.explanation})]}),t&&e.jsx("button",{onClick:n,className:"mt-6 px-5 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-medium",children:m<p?"Next Question":"Finish"})]})]}),W=({score:o,total:t,percentage:s,formatElapsedTime:n,passed:l,onRetake:m,onNextPart:p,userAnswers:x})=>{const[g,u]=a.useState(!1),N=()=>{u(!1),setTimeout(()=>window.print(),100)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4 text-green-700 antialiased",children:"âœ… Summary"}),e.jsxs("div",{className:"bg-white rounded-2xl shadow p-6 space-y-1 text-gray-800 antialiased",children:[e.jsxs("p",{children:["Points: ",o," / ",t]}),e.jsxs("p",{children:["Percentage Score: ",s.toFixed(2),"%"]}),e.jsxs("p",{children:["Total Time: ",n]})]}),e.jsxs("div",{className:"mt-6 flex flex-wrap gap-2 text-gray-800 antialiased",children:[e.jsx("button",{onClick:m,className:"px-4 py-2 bg-yellow-500 text-white rounded hover:bg-yellow-600 transition",children:"Retake"}),e.jsx("button",{onClick:p,disabled:!l,className:`px-4 py-2 rounded transition font-semibold text-white
              ${l?"bg-blue-500 hover:bg-blue-600":"bg-gray-300 cursor-not-allowed opacity-75"}`,children:"Next Part"}),e.jsx("button",{onClick:()=>u(!0),className:"px-4 py-2 bg-purple-500 text-white rounded hover:bg-purple-600 transition",children:"Print"})]}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-gray-800 antialiased",children:"Review of Answers:"}),x.map((c,d)=>e.jsxs("div",{className:"p-4 border rounded mb-4 bg-white text-gray-800 antialiased",children:[e.jsx("p",{className:"font-semibold mb-2",children:`${d+1}. ${c.question}`}),e.jsx("ul",{className:"list-disc list-inside mb-2",children:c.choices.map((f,h)=>{const w=f===c.correct?"text-green-600":f===c.selected?"text-red-600":"text-gray-700";return e.jsx("li",{className:w,children:f},h)})}),e.jsxs("p",{className:"text-sm",children:["Your Answer:"," ",e.jsx("span",{className:c.selected===c.correct?"text-green-600":"text-red-600",children:c.selected})]}),e.jsxs("p",{className:"text-sm",children:["Correct Answer:"," ",e.jsx("span",{className:"text-green-600",children:c.correct})]}),e.jsx("p",{className:"text-sm italic mt-1",children:c.explanation})]},d))]})]}),g&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50 print:hidden",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-sm w-full text-center text-gray-800 antialiased",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Support Our Site"}),e.jsx("p",{className:"mb-4",children:"If you find this site helpful, you can donate any amount by scanning the Gcash QR code below."}),e.jsx("img",{src:"/images/gcash-qr.webp",alt:"Donation QR Code",className:"mx-auto w-48 h-48 mb-4"}),e.jsx("button",{onClick:N,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition",children:"Continue to Print"})]})})]})},X=({subjectName:o,part:t,onStart:s})=>e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full text-center text-gray-900",children:[e.jsxs("h2",{className:"text-2xl font-bold mb-4",children:["Welcome to ",o," Part ",t]}),e.jsxs("p",{className:"mb-4",children:["You are about to start ",e.jsxs("strong",{children:["Part ",t]})," of ",e.jsx("strong",{children:o}),". Aim to score at least ",e.jsx("strong",{children:"80%"})," to unlock the next part!"]}),e.jsx("p",{className:"italic mb-6",children:"Stay focused and do your best. Youâ€™ve got this! ðŸ’ª"}),e.jsx("button",{onClick:s,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Start Quiz"})]})}),Z=Y.memo(X);function ee({isOpen:o,onContinue:t,groupLink:s,modalMessage:n,examName:l}){return o?(s||console.warn("[CommunityJoinModal] No groupLink provided."),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full text-center text-gray-900",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:l?`Join Our ${l} Facebook Community`:"Join Our Facebook Community"}),e.jsx("p",{className:"mb-4",children:n||"Before you continue, please join our FB group for free review materials:"}),s?e.jsx("button",{onClick:()=>window.open(s,"_blank"),className:"inline-block bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 mb-4",children:"Join the Group"}):e.jsx("div",{className:"text-red-600 mb-4",children:"Facebook group link is missing."}),e.jsx("br",{}),e.jsx("button",{onClick:t,className:"mt-2 bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Iâ€™ve Joined, Continue to Quiz"})]})})):null}const M=o=>{const t=[...o];for(let s=t.length-1;s>0;s--){const n=Math.floor(Math.random()*(s+1));[t[s],t[n]]=[t[n],t[s]]}return t},re=({questions:o,subjectId:t,subjectName:s,part:n,examId:l,seo:m,hasJoinedGroup:p,fbUrl:x,examName:g,modalMessage:u})=>{console.log("[Questions.tsx] Props â†’","examId:",l,"hasJoinedGroup:",p,"fbUrl:",x,"examName:",g,"modalMessage:",u);const[N,c]=a.useState(!0),[d,f]=a.useState([]),[h,w]=a.useState(0),[O,v]=a.useState(null),[$,J]=a.useState(0),[A,P]=a.useState([]),[S,E]=a.useState(!1),[y,k]=a.useState(0),[T,_]=a.useState(p),b=a.useRef(null);a.useEffect(()=>(b.current=window.setInterval(()=>k(i=>i+1),1e3),()=>{b.current&&window.clearInterval(b.current)}),[]),a.useEffect(()=>{S&&b.current&&window.clearInterval(b.current)},[S]);const C=a.useCallback(()=>{const i=M(o).map(r=>{const j=M(r.choices);return{...r,choices:j}});f(i),w(0),v(null),J(0),P([]),E(!1),k(0),b.current&&window.clearInterval(b.current),b.current=window.setInterval(()=>k(r=>r+1),1e3)},[o]);a.useEffect(()=>{C()},[C]);const q=a.useCallback(i=>{v(i);const r=d[h];i===r.answer&&J(j=>j+1),P(j=>{const F=[...j,{questionId:r.id,question:r.question,choices:r.choices,selected:i,correct:r.answer,explanation:r.explanation}],D=`prc_progress_${l}_${t}_${n}`;return window.localStorage.setItem(D,JSON.stringify({answered:F.length,total:d.length})),F})},[h,d,l,t,n]),I=()=>{if(h+1<d.length)w(i=>i+1),v(null);else{const i=`prc_unlocked_${l}_${t}`,r=JSON.parse(window.localStorage.getItem(i)||"[]");r.includes(n)||(r.push(n),window.localStorage.setItem(i,JSON.stringify(r))),E(!0)}},R=Math.round($/d.length*100),z=R>=80,G=[{label:"Home",href:"/"},{label:s,href:`/exams/${l}/subjects/${t}/parts`},{label:`Part ${n}`}],Q=h===4&&!T,B=async()=>{var i;console.log("[Questions.tsx] handleJoinedClick: examId =",l,"fbUrl =",x);try{await fetch(`/group-modal/joined/${l}`,{method:"POST",headers:{"X-CSRF-TOKEN":((i=document.querySelector('meta[name="csrf-token"]'))==null?void 0:i.getAttribute("content"))||""}})}catch(r){console.error("[Questions.tsx] Failed to mark joined:",r)}finally{_(!0)}};return e.jsxs(V,{children:[e.jsxs(K,{children:[e.jsx("title",{children:m.title}),e.jsx("meta",{name:"description",content:m.description}),e.jsx("link",{rel:"canonical",href:m.canonical})]}),N?e.jsx(Z,{subjectName:s,part:n,onStart:()=>c(!1)}):S?e.jsx("div",{className:"max-w-4xl mx-auto p-6",children:e.jsx(W,{score:$,total:d.length,percentage:R,formatElapsedTime:`${Math.floor(y/60)}m ${y%60}s`,passed:z,onRetake:C,onNextPart:()=>L.visit(`/exams/${l}/subjects/${t}/parts/${n+1}/questions`),userAnswers:A})}):e.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[e.jsx(H,{items:G}),Q?e.jsx(ee,{isOpen:Q,onContinue:B,groupLink:x,examName:g,modalMessage:u}):e.jsx(U,{currentQuestion:d[h],selectedChoice:O,onChoiceClick:q,onNext:I,questionNumber:h+1,totalQuestions:d.length,formatElapsedTime:`${Math.floor(y/60)}m ${y%60}s`})]})]})};export{re as default};
