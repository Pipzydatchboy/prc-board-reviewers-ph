const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/breadcrumbs-BFSz1lgF.js","assets/app-DEd94Euo.js","assets/app-CNwdJtTS.css","assets/QuestionView-D3Rp_xBx.js","assets/SummaryView-ClGrumx0.js","assets/LazyAdSlot-BPotuqzr.js","assets/IntroModal-MnFnMl2k.js","assets/RetakeModal-CwN6gQW-.js","assets/NextModal-fb4YtZ9l.js"])))=>i.map(i=>d[i]);
import{j as s,r as e,a as ee,_ as d,f as se}from"./app-DEd94Euo.js";import{L as te}from"./Layout-CyB2O3V7.js";import oe from"./AdSlot-CbcT_fqK.js";const ne=()=>null,ae=({isOpen:i,onClose:c,title:u,message:n})=>i?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 w-full max-w-md",children:[s.jsx("h2",{className:"text-xl font-bold mb-4 text-red-600",children:u}),s.jsx("p",{className:"mb-6 text-gray-700",children:n}),s.jsx("button",{onClick:c,className:"w-full bg-red-600 text-white py-2 rounded hover:bg-red-700 transition",children:"Close"})]})}):null,le=e.lazy(()=>d(()=>import("./breadcrumbs-BFSz1lgF.js"),__vite__mapDeps([0,1,2]))),re=e.lazy(()=>d(()=>import("./QuestionView-D3Rp_xBx.js"),__vite__mapDeps([3,1,2]))),ce=e.lazy(()=>d(()=>import("./SummaryView-ClGrumx0.js"),__vite__mapDeps([4,1,2,5]))),ie=e.lazy(()=>d(()=>import("./IntroModal-MnFnMl2k.js"),__vite__mapDeps([6,1,2]))),ue=e.lazy(()=>d(()=>import("./RetakeModal-CwN6gQW-.js"),__vite__mapDeps([7,1,2]))),de=e.lazy(()=>d(()=>import("./NextModal-fb4YtZ9l.js"),__vite__mapDeps([8,1,2]))),M=i=>[...i].sort(()=>Math.random()-.5),pe=({questions:i,subjectId:c,subjectName:u,part:n,examType:me,examId:m})=>{const[w,O]=e.useState(!0),[y,b]=e.useState(!1),[j,v]=e.useState(!1),[a,T]=e.useState(()=>M(i)),[l,E]=e.useState(0),[z,p]=e.useState(null),[N,k]=e.useState(0),[g,C]=e.useState(!1),[L,Q]=e.useState(!1),[V,R]=e.useState([]),[_,S]=e.useState(0),h=e.useRef(null),[q,P]=e.useState(!1),D=()=>O(!1),J=()=>b(!0),B=()=>v(!0),H=()=>{b(!1),F()},U=()=>{v(!1);const t=`prc_unlocked_${m}_${c}`,o=JSON.parse(localStorage.getItem(t)||"[1]"),f=n+1;o.includes(f)||(o.push(f),localStorage.setItem(t,JSON.stringify(o))),se.visit(`/exams/${m}/subjects/${c}/parts/${f}/questions`)},F=()=>{clearInterval(h.current),S(0),h.current=setInterval(()=>S(t=>t+1),1e3),T(M(i)),E(0),p(null),k(0),C(!1),R([])},$=e.useMemo(()=>{const t=a.length;return[Math.floor(t*.25),Math.floor(t*.75)]},[a.length]);e.useEffect(()=>(h.current=setInterval(()=>S(t=>t+1),1e3),()=>clearInterval(h.current)),[]),e.useEffect(()=>{g&&clearInterval(h.current)},[g]);const r=a[l],x=e.useCallback(()=>{l<a.length-1?(E(t=>t+1),p(null)):C(!0)},[l,a.length]),K=e.useCallback(()=>{$.includes(l+1)?P(!0):x()},[l,$,x]),Y=e.useCallback(()=>{P(!1),x()},[x]),G=e.useCallback(t=>{p(t),t===r.answer&&k(o=>o+1),R(o=>[...o,{questionId:r.id,question:r.question,choices:r.choices,selected:t,correct:r.answer,explanation:r.explanation}]);try{const o=`prc_progress_${m}_${c}_${n}`,f=l+1,Z=a.length;localStorage.setItem(o,JSON.stringify({answered:f,total:Z}))}catch(o){console.error("Failed to save progress:",o)}},[r,l,a.length,m,c,n]),A=e.useMemo(()=>`${Math.floor(_/60)}m ${_%60}s`,[_]),I=N/a.length*100,W=I>=80,X=[{label:"Home",href:"/"},{label:"Exams",href:"/exams"},{label:u,href:`/exams/${m}/subjects/${c}/parts`},{label:`Part ${n}`}];return s.jsxs(te,{children:[s.jsx(ee,{title:`${u} Part ${n} Questions | PRC Board Reviewers PH`,children:s.jsx("meta",{name:"description",content:`Part ${n} of ${u} quiz.`})}),s.jsxs(e.Suspense,{fallback:null,children:[w&&s.jsx(ie,{subjectName:u,part:n,onStart:D}),y&&s.jsx(ue,{onRetake:H}),j&&s.jsx(de,{part:n,onContinue:U})]}),!(w||y||j)&&s.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[s.jsx(e.Suspense,{fallback:s.jsx("div",{className:"mb-4 h-4 w-32 bg-gray-200 animate-pulse rounded"}),children:s.jsx(le,{items:X})}),s.jsx(ne,{isOpen:q,onClose:Y,children:s.jsx(oe,{slotId:"questions-popup-banner",className:"w-full h-64"})}),s.jsx(e.Suspense,{fallback:s.jsxs("div",{className:"animate-pulse space-y-4 py-10",children:[s.jsx("div",{className:"h-6 bg-gray-200 rounded w-3/4"}),s.jsx("div",{className:"h-48 bg-gray-200 rounded w-full"}),s.jsx("div",{className:"h-10 bg-gray-200 rounded w-1/2"})]}),children:g?s.jsx(ce,{score:N,total:a.length,percentage:I,formatElapsedTime:A,passed:W,userAnswers:V,onRetake:J,onNextPart:B}):s.jsx(re,{currentQuestion:r,selectedChoice:z,onChoiceClick:G,onNext:K,formatElapsedTime:A,questionNumber:l+1,totalQuestions:a.length})}),s.jsx(ae,{isOpen:L,onClose:()=>Q(!1),title:"Oops! ðŸ˜Ÿ",message:"You need at least 80% to proceed."})]})]})};export{pe as default};
